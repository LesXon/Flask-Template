document.addEventListener('DOMContentLoaded',function() {initAccessibilityFeatures();function initLoadingButtons() {const loadingButtons = document.querySelectorAll('button[data-loading-text]');loadingButtons.forEach(button => {button.addEventListener('click',function() {if (this.type === 'submit') {showLoadingState(this);}});const form = button.closest('form');if (form) {form.addEventListener('submit',function() {showLoadingState(button);});}});}function showLoadingState(button) {const originalText = button.querySelector('.button-text').textContent;const loadingText = button.getAttribute('data-loading-text');const spinner = button.querySelector('.spinner-border');button.disabled = true;button.classList.add('loading');button.querySelector('.button-text').textContent = loadingText;if (spinner) {spinner.classList.remove('d-none');}button.setAttribute('data-original-text',originalText);}function hideLoadingState(button) {const originalText = button.getAttribute('data-original-text');const spinner = button.querySelector('.spinner-border');button.disabled = false;button.classList.remove('loading');if (originalText) {button.querySelector('.button-text').textContent = originalText;}if (spinner) {spinner.classList.add('d-none');}}function initAutoDismissAlerts() {const dismissibleAlerts = document.querySelectorAll('.alert-dismissible');dismissibleAlerts.forEach(alert => {if (!alert.classList.contains('alert-danger')) {setTimeout(() => {const closeButton = alert.querySelector('.close');if (closeButton && alert.parentNode) {closeButton.click();}},5000);}});}function initFormValidation() {const forms = document.querySelectorAll('form');forms.forEach(form => {const inputs = form.querySelectorAll('.form-control');inputs.forEach(input => {input.addEventListener('blur',function() {validateInput(this);});input.addEventListener('input',function() {if (this.classList.contains('is-invalid')) {this.classList.remove('is-invalid');const feedback = this.parentNode.querySelector('.invalid-feedback');if (feedback) {feedback.style.display = 'none';}}});});});}function validateInput(input) {const value = input.value.trim();const isRequired = input.hasAttribute('required');const type = input.getAttribute('type');let isValid = true;let errorMessage = '';if (isRequired && !value) {isValid = false;errorMessage = 'This field is required.';}if (type === 'email' && value) {const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;if (!emailRegex.test(value)) {isValid = false;errorMessage = 'Please enter a valid email address.';}}if (type === 'password' && value && value.length < 6) {isValid = false;errorMessage = 'Password must be at least 6 characters long.';}if (!isValid) {input.classList.add('is-invalid');showValidationError(input,errorMessage);}else {input.classList.remove('is-invalid');hideValidationError(input);}return isValid;}function showValidationError(input,message) {let feedback = input.parentNode.querySelector('.invalid-feedback');if (!feedback) {feedback = document.createElement('div');feedback.className = 'invalid-feedback';input.parentNode.appendChild(feedback);}feedback.textContent = message;feedback.style.display = 'block';}function hideValidationError(input) {const feedback = input.parentNode.querySelector('.invalid-feedback');if (feedback) {feedback.style.display = 'none';}}function initModalEnhancements() {const modals = document.querySelectorAll('.modal');modals.forEach(modal => {modal.addEventListener('shown.bs.modal',function() {const firstInput = this.querySelector('input,textarea,select,button');if (firstInput) {firstInput.focus();}});modal.addEventListener('hidden.bs.modal',function() {const form = this.querySelector('form');if (form) {form.reset();const invalidInputs = form.querySelectorAll('.is-invalid');invalidInputs.forEach(input => {input.classList.remove('is-invalid');});const feedbacks = form.querySelectorAll('.invalid-feedback');feedbacks.forEach(feedback => {feedback.style.display = 'none';});}});});}function initTooltips() {const tooltipElements = document.querySelectorAll('[title]');tooltipElements.forEach(element => {if (element.tagName === 'BUTTON' && element.querySelector('i')) {element.setAttribute('data-toggle','tooltip');element.setAttribute('data-placement','top');}});if (typeof $ !== 'undefined' && $.fn.tooltip) {$('[data-toggle="tooltip"]').tooltip();}}function animateProgressBars() {const progressBars = document.querySelectorAll('.progress-bar');progressBars.forEach(bar => {const width = bar.style.width;bar.style.width = '0%';setTimeout(() => {bar.style.width = width;},100);});}initLoadingButtons();initAutoDismissAlerts();initFormValidation();initModalEnhancements();initTooltips();animateProgressBars();initKeyboardNavigation();initScreenReaderSupport();function initAccessibilityFeatures() {document.addEventListener('keydown',function(e) {if (e.key === 'Tab') {document.body.classList.add('keyboard-navigation');}});document.addEventListener('mousedown',function() {document.body.classList.remove('keyboard-navigation');});const observer = new MutationObserver(function(mutations) {mutations.forEach(function(mutation) {if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {mutation.addedNodes.forEach(function(node) {if (node.nodeType === Node.ELEMENT_NODE) {if (node.classList && (node.classList.contains('alert') || node.getAttribute('role') === 'alert')) {announceToScreenReader(node.textContent.trim());}}});}});});observer.observe(document.body,{childList:true,subtree:true });}function initKeyboardNavigation() {document.addEventListener('keydown',function(e) {if (e.key === 'Escape') {const openModal = document.querySelector('.modal.show');if (openModal) {const closeButton = openModal.querySelector('[data-dismiss="modal"]');if (closeButton) {closeButton.click();}}const openDropdowns = document.querySelectorAll('.dropdown-menu.show');openDropdowns.forEach(dropdown => {dropdown.classList.remove('show');const toggle = dropdown.previousElementSibling;if (toggle) {toggle.setAttribute('aria-expanded','false');toggle.focus();}});const focusedAlert = document.activeElement;if (focusedAlert && focusedAlert.classList.contains('alert')) {const closeButton = focusedAlert.querySelector('[data-dismiss="alert"]');if (closeButton) {closeButton.click();}}}});const formElements = document.querySelectorAll('input,textarea,select,button');formElements.forEach(element => {element.addEventListener('focus',function() {this.scrollIntoView({behavior:'smooth',block:'nearest' });});});document.addEventListener('keydown',function(e) {const activeElement = document.activeElement;if (activeElement && activeElement.classList.contains('dropdown-toggle')) {if (e.key === 'ArrowDown' || e.key === 'Enter' || e.key === ' ') {e.preventDefault();const dropdown = activeElement.nextElementSibling;if (dropdown && dropdown.classList.contains('dropdown-menu')) {dropdown.classList.add('show');activeElement.setAttribute('aria-expanded','true');const firstItem = dropdown.querySelector('a,button');if (firstItem) {firstItem.focus();}}}}if (activeElement && activeElement.closest('.dropdown-menu')) {const dropdownMenu = activeElement.closest('.dropdown-menu');const items = Array.from(dropdownMenu.querySelectorAll('a,button'));const currentIndex = items.indexOf(activeElement);if (e.key === 'ArrowDown') {e.preventDefault();const nextIndex = (currentIndex + 1) % items.length;items[nextIndex].focus();}else if (e.key === 'ArrowUp') {e.preventDefault();const prevIndex = currentIndex > 0 ? currentIndex - 1 :items.length - 1;items[prevIndex].focus();}}});}function initScreenReaderSupport() {let announcer = document.getElementById('sr-announcements');if (!announcer) {announcer = document.createElement('div');announcer.id = 'sr-announcements';announcer.setAttribute('aria-live','polite');announcer.setAttribute('aria-atomic','true');announcer.className = 'sr-only';document.body.appendChild(announcer);}document.addEventListener('invalid',function(e) {const field = e.target;const label = document.querySelector(`label[for="${field.id}"]`);const fieldName = label ? label.textContent.trim() :field.name;setTimeout(() => {announceToScreenReader(`Validation error in ${fieldName}:${field.validationMessage}`);},100);},true);document.addEventListener('submit',function(e) {const form = e.target;if (form.checkValidity()) {announceToScreenReader('Form submitted successfully');}});const loadingButtons = document.querySelectorAll('[data-loading-text]');loadingButtons.forEach(button => {button.addEventListener('click',function() {if (this.type === 'submit') {setTimeout(() => {announceToScreenReader(this.getAttribute('data-loading-text'));},100);}});});}function announceToScreenReader(message) {const announcer = document.getElementById('sr-announcements');if (announcer && message) {announcer.textContent = '';setTimeout(() => {announcer.textContent = message.trim();},100);setTimeout(() => {announcer.textContent = '';},3000);}}window.UIComponents = {showLoadingState:showLoadingState,hideLoadingState:hideLoadingState,validateInput:validateInput,showValidationError:showValidationError,hideValidationError:hideValidationError,announceToScreenReader:announceToScreenReader };});function showAlert(message,type = 'info',dismissible = true,container = 'body') {const alertHtml = ` <div class="alert alert-${type}${dismissible ? 'alert-dismissible' :''}fade show" role="alert"> ${message}${dismissible ? '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' :''}</div> `;const containerElement = document.querySelector(container);if (containerElement) {containerElement.insertAdjacentHTML('afterbegin',alertHtml);if (dismissible && type !== 'danger') {setTimeout(() => {const alert = containerElement.querySelector('.alert');if (alert) {const closeButton = alert.querySelector('.close');if (closeButton) {closeButton.click();}}},5000);}}}window.showAlert = showAlert;